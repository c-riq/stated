<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Statement Editor</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="editor-styles.css">
</head>
<body>
    <div class="top-bar">
        <div class="top-bar-content">
            <div class="header-left">
                <img src="logo.png" alt="Logo" class="header-logo">
                <h1>globalcoordination.org<span class="subtitle">Statement Editor</span></h1>
            </div>
            <div class="header-right">
                <a href="/" class="btn-link">‚Üê Back to Viewer</a>
            </div>
        </div>
    </div>

    <div class="container editor-container">
        <div id="message" class="message" style="display: none;"></div>

        <div class="editor-layout">
            <!-- Left Panel: Form -->
            <div class="editor-panel editor-form-panel">
                <h2>Create Statement</h2>
                
                <form id="statementForm">
                    <!-- Basic Information -->
                    <div class="form-section">
                        <h3>Basic Information</h3>
                        
                        <div class="form-group">
                            <label for="domain">Publishing Domain *</label>
                            <input type="text" id="domain" class="form-input" placeholder="example.com" required>
                            <small>The domain publishing this statement</small>
                        </div>

                        <div class="form-group">
                            <label for="author">Author *</label>
                            <input type="text" id="author" class="form-input" placeholder="Organization Name" required>
                            <small>The name of the organization or person</small>
                        </div>

                        <div class="form-group">
                            <label for="statementType">Statement Type</label>
                            <select id="statementType" class="form-select">
                                <option value="">Basic Statement</option>
                                <option value="poll">Poll</option>
                                <option value="vote">Vote</option>
                                <option value="organisation_verification">Organisation Verification</option>
                                <option value="person_verification">Person Verification</option>
                                <option value="response">Response</option>
                                <option value="rating">Rating</option>
                                <option value="sign_pdf">Sign PDF</option>
                                <option value="dispute_statement_authenticity">Dispute Authenticity</option>
                                <option value="dispute_statement_content">Dispute Content</option>
                            </select>
                            <small id="typeHelp" class="type-help"></small>
                        </div>

                        <div class="form-group">
                            <label for="content">Statement Content *</label>
                            <textarea id="content" class="form-textarea" rows="8" placeholder="Enter your statement content here..." required></textarea>
                            <small>The main content of your statement. For typed statements, the Type: field will be added automatically.</small>
                        </div>
                    </div>

                    <!-- Optional Fields -->
                    <div class="form-section">
                        <h3>Optional Fields</h3>

                        <div class="form-group">
                            <label>Tags</label>
                            <div id="tagsContainer" class="dynamic-container"></div>
                            <button type="button" id="addTag" class="btn-secondary">+ Add Tag</button>
                            <small>Add tags to categorize your statement</small>
                        </div>

                        <div class="form-group">
                            <label for="supersededStatement">Superseded Statement Hash</label>
                            <input type="text" id="supersededStatement" class="form-input" placeholder="Previous statement hash">
                            <small>If this statement replaces a previous one, enter its hash</small>
                        </div>

                        <div class="form-group">
                            <label>Translations</label>
                            <div id="translationsContainer" class="dynamic-container"></div>
                            <button type="button" id="addTranslation" class="btn-secondary">+ Add Translation</button>
                            <small>Add translations in other languages (use ISO 639-1 codes: es, fr, de, etc.)</small>
                        </div>

                        <div class="form-group">
                            <label>Attachments</label>
                            <div id="attachmentsContainer" class="dynamic-container"></div>
                            <button type="button" id="addAttachment" class="btn-secondary">+ Add Attachment</button>
                            <small>Add attachment hashes (files must be uploaded separately to /.well-known/statements/attachments/)</small>
                        </div>
                    </div>

                    <!-- Cryptographic Signing -->
                    <div class="form-section">
                        <h3>Cryptographic Signing</h3>
                        
                        <div class="form-group">
                            <label class="checkbox-label">
                                <input type="checkbox" id="signStatement">
                                <span>Sign this statement with Ed25519 signature</span>
                            </label>
                            <small>Signing provides cryptographic proof of authenticity and prevents tampering</small>
                        </div>

                        <div id="signingFields" style="display: none;">
                            <div class="form-group">
                                <label for="publicKey">Public Key</label>
                                <input type="text" id="publicKey" class="form-input" placeholder="Public key (base64)" readonly>
                            </div>

                            <div class="form-group">
                                <label for="privateKey">Private Key</label>
                                <input type="password" id="privateKey" class="form-input" placeholder="Private key (base64)" readonly>
                                <small class="warning">‚ö†Ô∏è Keep your private key secure! Never share it.</small>
                            </div>

                            <button type="button" id="generateKeys" class="btn-secondary">Generate New Key Pair</button>
                        </div>
                    </div>

                    <!-- Submit Button -->
                    <div class="form-actions">
                        <button type="submit" class="btn-primary">Generate Statement</button>
                    </div>
                </form>
            </div>

            <!-- Right Panel: Output -->
            <div class="editor-panel editor-output-panel">
                <h2>Generated Statement</h2>
                
                <div class="output-section">
                    <h3>Preview</h3>
                    <div id="statementPreview" class="statement-preview">
                        <p class="placeholder-text">Your generated statement will appear here...</p>
                    </div>
                </div>

                <div class="output-section">
                    <h3>Raw Statement</h3>
                    <textarea id="outputStatement" class="output-textarea" readonly placeholder="Generated statement text will appear here..."></textarea>
                    <div id="statementHash" class="statement-hash"></div>
                </div>

                <div class="output-actions">
                    <button type="button" id="copyStatement" class="btn-secondary">üìã Copy to Clipboard</button>
                    <button type="button" id="downloadStatement" class="btn-secondary">üíæ Download as .txt</button>
                </div>

                <div class="help-section">
                    <h3>Next Steps</h3>
                    <ol>
                        <li>Copy or download the generated statement</li>
                        <li>Save it to <code>/.well-known/statements/&lt;hash&gt;.txt</code></li>
                        <li>Add the filename to <code>/.well-known/statements/index.txt</code></li>
                        <li>Optionally add to <code>/.well-known/statements.txt</code></li>
                        <li>If you have attachments, upload them to <code>/.well-known/statements/attachments/</code></li>
                    </ol>
                </div>
            </div>
        </div>
    </div>

    <script type="module" src="dist/editor-app.js"></script>
</body>
</html>